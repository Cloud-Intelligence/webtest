---
import Layout from 'src/layouts/Layout.astro';
import UnlockScreen from 'src/components/home/UnlockScreen.astro';
import Hero from 'src/components/home/Hero.astro';
import About from 'src/components/home/About.astro';
import Testimonials from 'src/components/home/Testimonials.astro';
import ClientLogos from 'src/components/home/ClientLogos.astro';
---

<Layout 
  title="Cloud Intelligence - Unlock the Power of Intelligent Cloud Solutions"
  description="Transform your business with our enterprise-grade cloud intelligence platform. Lightning fast deployment, enterprise security, real-time analytics, and auto-scaling features."
  keywords="cloud intelligence, enterprise cloud, cloud platform, business transformation, cloud computing, data analytics, auto-scaling, cloud security"
>
  <!-- NoScript Info Banner -->
  <noscript>
    <div class="no-js-message">
      âš¡ Enable JavaScript for the full interactive experience with animations and enhanced features.
    </div>
  </noscript>
  
  <!-- Unlock Screen Animation -->
  <div id="unlock-screen-container">
    <UnlockScreen />
  </div>
  
  <!-- Main Landing Page Content -->
  <div id="mainScreen" style="visibility: hidden; opacity: 0;">
    <main id="main">
      <Hero />
      <About />
      <Testimonials />
      <ClientLogos />
    </main>
  </div>

</Layout>

<style>
  /* Default: apply overflow hidden for unlock screen */
  body {
    overflow: hidden;
    height: 100vh;
  }
  
  
  /* Hide unlock screen when skipped */
  body.skip-lock-screen #unlock-screen-container {
    display: none !important;
  }
  
  /* Show main content when lock screen is skipped */
  body.skip-lock-screen #navbar-container {
    display: block !important;
    opacity: 1 !important;
  }
  
  body.skip-lock-screen #mainScreen {
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* Remove overflow restriction when lock screen is skipped */
  body.skip-lock-screen {
    overflow: auto !important;
    height: auto !important;
  }
</style>

<script>
  // Check URL hash immediately to avoid flash
  (function() {
    // Check if URL has any hash present
    if (window.location.hash) {
      document.body.classList.add('skip-lock-screen');
      // Ensure scroll is enabled when skipping lock screen
      if (window.innerWidth <= 768) {
        // Mobile: use browser defaults
        document.body.style.overflow = '';
        document.body.style.height = '';
      } else {
        // Desktop: explicitly set auto
        document.body.style.overflow = 'auto';
        document.body.style.height = 'auto';
      }
    }
  })();
  
  // Additional safeguard - ensure scroll is restored after unlock
  document.addEventListener('slider-unlock', () => {
    setTimeout(() => {
      if (window.innerWidth <= 768) {
        // Mobile: remove inline styles to use browser defaults
        document.body.style.overflow = '';
        document.body.style.height = '';
        document.documentElement.style.overflow = '';
        document.documentElement.style.height = '';
      } else {
        // Desktop: explicitly set auto
        document.body.style.overflow = 'auto';
        document.body.style.height = 'auto';
        document.documentElement.style.overflow = 'auto';
        document.documentElement.style.height = 'auto';
      }
    }, 100);
  });
</script>
